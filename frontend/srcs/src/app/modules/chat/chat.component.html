<p align="center">chat works!</p>

<!-- app.component.html -->
<button (click)="newChat()">newChat</button>
<!-- <li *ngFor="let item of items; index as i; trackBy: trackByFn" -->
<div *ngIf="users.length" class="sidebar">
    <h2>Usuarios disponibles</h2>
    <ul>
        <li *ngFor="let user of users">
            <a (click)="loadNewChat(user)" >{{ user.username }}
                <ng-container
                *ngIf="
                    conectedUsers.has(user.userId);
                    then isConnected;
                    else isDiconnected
                "
                >
                </ng-container>
                <ng-template #isConnected>ðŸŸ¢</ng-template>
                <ng-template #isDiconnected>ðŸ”´</ng-template>
            </a>
        </li>
    </ul>
</div>
<div class="chat-app">
    <!-- Barra lateral con la lista de usuarios disponibles -->
    <div class="sidebar">
        <h2>Chats disponibles</h2>
        <ul>
            <li *ngFor="let chat of chatsAvailables">
                <a (click)="loadChat(chat)">{{ chat.username }}
                <ng-container
                    *ngIf="
                        conectedUsers.has(chat.userId);
                        then isConnected;
                        else isDiconnected
                    "
                >
                </ng-container>
                <ng-template #isConnected>ðŸŸ¢</ng-template>
                <ng-template #isDiconnected>ðŸ”´</ng-template>
                â€‹</a>

            </li>
        </ul>
    </div>

    <!-- Ventana de chat -->
    <div class="chat-window">
        <div *ngIf="currentChat.chatId != 'none'">
            <h2>Chat con {{ currentChat.username }} <ng-container
                *ngIf="
                    conectedUsers.has(currentChat.userId);
                    then isConnected;
                    else isDiconnected
                "
            >
            </ng-container>
            <ng-template #isConnected>ðŸŸ¢</ng-template>
            <ng-template #isDiconnected>ðŸ”´</ng-template>
            </h2>
            <!-- AquÃ­ se mostrarÃ­an los mensajes del chat -->
            <!-- Por simplicidad, asumimos que hay un arreglo de mensajes llamado 'messages' -->
            <div class="chat-messages">
                <div *ngFor="let message of currentChatMessages">
                    <ng-container
                        *ngIf="
                            message.chatUserId != currentChat.chatUserId;
                            then alignRight;
                            else alignLeft
                        "
                    >
                    </ng-container>
                    <ng-template #alignRight>
                        <p style="text-align: right">
                            {{ message.message }}
                        </p>
                    </ng-template>
                    <ng-template #alignLeft>
                        <p>{{ message.message }}</p>
                    </ng-template>
                </div>
            </div>

            <!-- Formulario para enviar mensajes -->
            <!-- <form (submit)="sendMessage()"> -->
            <!-- [(ngModel)]="inputValue" -->
            <div class="input">
                <input
                    placeholder="Escribe un mensaje"
                    type="text"
                    [(ngModel)]="inputValue"
                    (keyup.enter)="sendMessage()"
                    (keydown)="startTyping()"
                    (blur)="stopTyping()"
                />
            </div>
            <!-- <input
            placeholder="Escribe un mensaje"
            type="text"
            (keyup.enter)="saveMessage()"
            (keydown)="startTyping()"
            (blur)="stopTyping()"
          /> -->
            <!-- <button type="submit">Enviar</button> -->
            <!-- </form> -->
        </div>
        <div *ngIf="currentChat.chatId == 'none'">
            <p>Selecciona un usuario para empezar a chatear.</p>
        </div>
    </div>
</div>
